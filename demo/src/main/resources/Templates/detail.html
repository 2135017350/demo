<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${item.title} + ' - 萌谷集市'">商品详情</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.staticfile.org/layui/2.8.18/css/layui.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-light">

<nav class="navbar navbar-light bg-white shadow-sm mb-4">
    <div class="container">
        <a class="navbar-brand text-pink fw-bold" href="/"><i class="fa-solid fa-gift me-2"></i>萌谷集市</a>
        <a href="/" class="btn btn-sm btn-outline-secondary">返回列表</a>
    </div>
</nav>

<div class="container mb-5">
    <div class="row g-4">
        <!-- 左侧：媒体展示 -->
        <div class="col-lg-7">
            <div class="card border-0 shadow-sm p-3">
                <!-- 主图/视频区域 -->
                <div class="ratio ratio-1x1 bg-light rounded overflow-hidden mb-3 position-relative">
                    <!-- 如果有视频，优先展示视频 -->
                    <video th:if="${item.videoUrl != null}" controls class="w-100 h-100 object-fit-contain">
                        <source th:src="${item.videoUrl}" type="video/mp4">
                        您的浏览器不支持视频播放。
                    </video>
                    <!-- 否则展示封面 -->
                    <img th:if="${item.videoUrl == null}" th:src="${item.coverUrl}" class="w-100 h-100 object-fit-contain">
                </div>

                <!-- 缩略图列表 -->
                <div class="d-flex gap-2 overflow-auto" style="white-space: nowrap;">
                    <img th:src="${item.coverUrl}" class="rounded border" width="80" height="80" style="object-fit:cover; cursor:pointer;">
                    <img th:if="${item.detailImages != null}" th:each="img : ${item.detailImages}" th:src="${img}" class="rounded border" width="80" height="80" style="object-fit:cover; cursor:pointer;">
                </div>
            </div>

            <!-- 鉴定报告 -->
            <div class="card border-0 shadow-sm mt-3" th:if="${item.verified}">
                <div class="card-body bg-success bg-opacity-10 rounded border border-success border-opacity-25">
                    <h5 class="fw-bold text-success"><i class="fa-solid fa-certificate me-2"></i>官方鉴定通过</h5>
                    <p class="mb-0 small" th:text="${item.verifyReport}">鉴定报告信息</p>
                </div>
            </div>
        </div>

        <!-- 右侧：商品信息 -->
        <div class="col-lg-5">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body p-4">
                    <div class="d-flex align-items-center mb-2">
                        <span class="badge bg-pink me-2" th:text="${item.category}">分类</span>
                        <span class="badge bg-secondary me-2" th:text="${item.ip}">IP</span>
                        <span class="text-muted small ms-auto">发布于 2小时前</span>
                    </div>

                    <h3 class="fw-bold mb-3" th:text="${item.title}">商品标题</h3>

                    <div class="d-flex align-items-baseline mb-4 p-3 bg-light rounded">
                        <span class="fs-5 text-pink fw-bold me-1">¥</span>
                        <span class="display-4 text-pink fw-bold me-3" th:text="${item.price}">价格</span>
                        <span class="badge bg-info text-dark" th:if="${item.status == 3}">预售商品</span>
                    </div>

                    <!-- 参数表 -->
                    <div class="row g-3 mb-4 small text-muted">
                        <div class="col-6">
                            <span class="d-block mb-1">成色状态</span>
                            <span class="fw-bold text-dark" th:text="${item.condition}">全新</span>
                        </div>
                        <div class="col-6">
                            <span class="d-block mb-1">附件情况</span>
                            <span class="fw-bold text-dark" th:text="${item.accessories}">盒说全</span>
                        </div>
                        <div class="col-6" th:if="${item.serialNum != null}">
                            <span class="d-block mb-1">商品编号</span>
                            <span class="fw-bold text-dark font-monospace" th:text="${item.serialNum}">SN-123</span>
                        </div>
                        <div class="col-6">
                            <span class="d-block mb-1">卖家</span>
                            <a href="#" class="fw-bold text-pink text-decoration-none" th:text="${item.seller}">卖家昵称</a>
                        </div>
                    </div>

                    <hr>

                    <h6 class="fw-bold mb-2">商品详情</h6>
                    <p class="text-secondary" style="white-space: pre-wrap;" th:text="${item.description}">描述内容...</p>

                    <div class="mt-5">
                        <button class="btn btn-pink w-100 py-3 rounded-pill fs-5 fw-bold btn-buy"
                                th:data-id="${item.id}"
                                th:data-price="${item.price}"
                                th:disabled="${item.status != 0 && item.status != 3}">
                            <i class="fa-solid fa-cart-shopping me-2"></i>
                            <span th:text="${item.status == 1 ? '交易进行中' : (item.status == 2 ? '已售出' : '立即购买')}">立即购买</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.staticfile.org/jquery/3.6.4/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/layui/2.8.18/layui.js"></script>
<script src="/js/trade.js"></script>
</body>
</html>